# å°ä¹ AI å¼€å‘ä¼šè¯è®°å½•

> **é‡è¦**: VS Code é‡å¯åå‚è€ƒæ­¤æ–‡ä»¶æ¢å¤ä¸Šä¸‹æ–‡

## ğŸ“Œ æ ‡å‡†å¯åŠ¨æµç¨‹ï¼ˆå·²éªŒè¯ï¼‰

### åç«¯å¯åŠ¨
```bash
cd /Users/rockts/Dev/xiaole-ai
/Users/rockts/Dev/xiaole-ai/.venv/bin/python main.py
```
- ç«¯å£: 8000
- è™šæ‹Ÿç¯å¢ƒ: `.venv` (Python 3.13.5)
- ä¾èµ–: requirements.txt

### å‰ç«¯å¯åŠ¨
```bash
source ~/.nvm/nvm.sh && nvm use 20
cd /Users/rockts/Dev/xiaole-ai/frontend
npm run dev
```
- ç«¯å£: 3000
- Node ç‰ˆæœ¬: v20.17.0
- åŒ…ç®¡ç†å™¨: npm v11.3.0

### å¿«é€Ÿæ£€æŸ¥å‘½ä»¤
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
lsof -i :8000 -i :3000 | grep LISTEN

# éªŒè¯å¥åº·
curl http://localhost:8000/docs
curl http://localhost:3000
```

---

## ğŸ”§ å½“å‰é¡¹ç›®ç»“æ„

### åç«¯å…³é”®æ–‡ä»¶
- `main.py` - FastAPI ä¸»å…¥å£
- `conversation.py` - å¯¹è¯ç®¡ç†
- `memory.py` - è®°å¿†ç³»ç»Ÿ
- `agent.py` - AI ä»£ç†
- `tool_manager.py` - å·¥å…·ç®¡ç†
- `db_setup.py` - æ•°æ®åº“åˆå§‹åŒ–

### å‰ç«¯å…³é”®ç›®å½•
- `frontend/src/views/ChatView.vue` - èŠå¤©ä¸»è§†å›¾
- `frontend/src/components/` - ç»„ä»¶åº“
- `frontend/src/stores/chat.js` - Pinia çŠ¶æ€ç®¡ç†
- `frontend/src/services/api.js` - API å°è£…

---

## ğŸ“ æœ€è¿‘æ”¹åŠ¨è®°å½•

### 2025-11-20 ChatGPT é£æ ¼å¯¹è¯ç•Œé¢ä¼˜åŒ–
**ä¸»è¦æ–‡ä»¶**: `frontend/src/views/ChatView.vue`

#### âœ… ä»£ç å—æ ·å¼ä¼˜åŒ–
- æ·»åŠ æ·±è‰²å¤´éƒ¨æ ï¼ˆæ¸å˜èƒŒæ™¯ + æ¯›ç»ç’ƒæ•ˆæœï¼‰
- å·¦ä¾§è¯­è¨€æ ‡ç­¾ï¼šå¤§å†™èƒ¶å›Šæ ·å¼ï¼ŒèƒŒæ™¯è‰²åŒºåˆ†
- å³ä¾§å¤åˆ¶æŒ‰é’®ï¼šå¸¦å›¾æ ‡å’Œ"å¤åˆ¶ä»£ç "æ–‡å­—ï¼Œhover æ‚¬æµ®æ•ˆæœ
- ä»£ç åŒºåŸŸå†…è¾¹è·ï¼š16px 20pxï¼Œè¡Œé«˜ 1.75
- è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼
- ä¿®å¤ä»£ç é«˜äº®åŒé‡è½¬ä¹‰é—®é¢˜ï¼ˆæ·»åŠ  `sanitize: false`ï¼‰
- ä½¿ç”¨ `:deep()` ç©¿é€é€‰æ‹©å™¨ç¡®ä¿åŠ¨æ€å…ƒç´ æ ·å¼ç”Ÿæ•ˆ

#### âœ… å¯¹è¯å®½åº¦ç»Ÿä¸€
- å¯¹è¯åŒºåŸŸ `.chat-inner`: 768px â†’ 680px
- è¾“å…¥æ¡† `.input-wrapper`: 768px â†’ 680px
- æ¬¢è¿é¡µè¾“å…¥æ¡†: åŒæ­¥è°ƒæ•´ä¸º 680px

#### âœ… åˆ—è¡¨æ ·å¼å¢å¼º
- å·¦ä¾§ç¼©è¿›ï¼š1.6em â†’ 2em
- æ·»åŠ  `list-style-position: outside`
- æ˜ç¡®æŒ‡å®šé¡¹ç›®ç¬¦å·ç±»å‹ï¼ˆå®å¿ƒåœ†ã€æ•°å­—ã€ç©ºå¿ƒåœ†ã€æ–¹å—ï¼‰
- li å…ƒç´ å¢åŠ  0.3em padding-left

#### âœ… å›åˆ°åº•éƒ¨æŒ‰é’®ä¼˜åŒ–
- æ”¹ä¸ºåœ†å½¢æŒ‰é’®ï¼š44px ç›´å¾„
- åœ¨å¯¹è¯åŒºåŸŸå†…å±…ä¸­ï¼ˆ`.chat-inner` æ·»åŠ  `position: relative`ï¼‰
- ä½ç½®ï¼š`position: absolute, bottom: 120px`
- æ·»åŠ æ·¡å…¥åŠ¨ç”»å’Œ hover æ‚¬æµ®æ•ˆæœ
- hover æ—¶è¾¹æ¡†å˜ä¸ºå“ç‰Œè‰²
- å›¾æ ‡ï¼šå‘ä¸‹ç®­å¤´ï¼ˆå·²æœ‰ï¼‰

#### ğŸ”§ æŠ€æœ¯ç»†èŠ‚
```css
/* ä»£ç å—å¤´éƒ¨ */
.md-content :deep(.code-header) {
  background: linear-gradient(180deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.3) 100%);
  backdrop-filter: blur(10px);
}

/* å¯¹è¯å®½åº¦ */
.chat-inner { max-width: 680px; }
.input-wrapper { max-width: 680px; }

/* åˆ—è¡¨ç¼©è¿› */
.md-content :deep(ul), .md-content :deep(ol) {
  padding-left: 2em;
  list-style-position: outside;
}

/* å›åˆ°åº•éƒ¨æŒ‰é’® */
.scroll-to-bottom {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  border-radius: 50%;
}
```

#### âš ï¸ é—ç•™é—®é¢˜
- ä»£ç å—å¤åˆ¶æŒ‰é’®ä½ç½®å¯èƒ½ä»éœ€å¾®è°ƒï¼ˆæµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼‰
- éœ€éªŒè¯æ‰€æœ‰æ ·å¼åœ¨åˆ·æ–°åæ­£ç¡®åº”ç”¨

### 2025-11-19 æ€§èƒ½ä¼˜åŒ–
- âœ… æ·»åŠ  VS Code æ€§èƒ½é…ç½® (`.vscode/settings.json`)
- âœ… æ’é™¤å¤§æ–‡ä»¶å¤¹ç›‘å¬å‡å°‘ CPU å ç”¨
- âœ… ä¼˜åŒ–ç»ˆç«¯æ»šåŠ¨ç¼“å†²
- âœ… å¯ç”¨è‡ªåŠ¨ä¿å­˜

### å¾…åŠäº‹é¡¹
- [ ] æ·»åŠ æ¶ˆæ¯æ·¡å…¥åŠ¨ç”»
- [ ] å®ç°å¤åˆ¶æˆåŠŸè½»é‡æç¤º
- [ ] å›¾ç‰‡æ‡’åŠ è½½ä¼˜åŒ–
- [ ] ä»£ç å—è¡Œå·æ”¯æŒï¼ˆå¯é€‰ï¼‰
- [ ] ä»£ç å—æ™ºèƒ½æŠ˜å ï¼ˆé•¿ä»£ç ï¼‰

---

## ğŸ› å·²çŸ¥é—®é¢˜

1. **FastAPI è­¦å‘Š**: `on_event` å·²å¼ƒç”¨
   - ä½ç½®: `main.py:139, 152`
   - å¾…è¿ç§»åˆ° `lifespan` äº‹ä»¶å¤„ç†å™¨

2. **å†å²å¯¹è¯åˆ‡æ¢**
   - éƒ¨åˆ†ä¼šè¯ç‚¹å‡»æ— å“åº”
   - éœ€æ£€æŸ¥è·¯ç”±å’Œ store é€»è¾‘

---

## ğŸ’¡ å¼€å‘æç¤º

### çƒ­æ›´æ–°
- å‰ç«¯: Vite è‡ªåŠ¨çƒ­æ›´æ–°
- åç«¯: éœ€æ‰‹åŠ¨é‡å¯ï¼ˆæˆ–ä½¿ç”¨ `uvicorn --reload`ï¼‰

### æ•°æ®åº“
- ç±»å‹: PostgreSQL (NAS éƒ¨ç½²)
- è¿æ¥é…ç½®: ç¯å¢ƒå˜é‡æˆ– `db_setup.py`
- è¿ç§»: `db_migrations/` ç›®å½•

### API æ–‡æ¡£
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

---

## ğŸš€ å¿«é€Ÿå‘½ä»¤å¤‡å¿˜

```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
pkill -f "python.*main.py"
pkill -f "vite"

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/backend.log
tail -f logs/frontend.log

# æ¸…ç†ç¼“å­˜
rm -rf frontend/node_modules/.vite
rm -rf __pycache__

# ä¾èµ–å®‰è£…
pip install -r requirements.txt
cd frontend && npm install
```

---

**æœ€åæ›´æ–°**: 2025-11-20 01:30
**ä¼šè¯çŠ¶æ€**: å°ä¹æ­£å¸¸è¿è¡Œï¼ŒChatGPT é£æ ¼ç•Œé¢ä¼˜åŒ–å®Œæˆ
**å½“å‰ä»»åŠ¡**: å¯¹è¯ç•Œé¢ç¾åŒ–ï¼Œä»£ç å—æ ·å¼ä¼˜åŒ–

---

### 2025-11-20 æ™ºèƒ½ä¸»æŒ‰é’®ä¸å›å¤åŠ¨ç”»å¢å¼ºï¼ˆç¬¬äºŒé˜¶æ®µï¼‰
**ä¸»è¦æ–‡ä»¶**: `frontend/src/views/ChatView.vue`, `frontend/src/stores/chat.js`

#### âœ… ä¸‰æ€ä¸»æŒ‰é’®
- ç©ºè¾“å…¥ï¼šè¯­éŸ³æ¨¡å¼ï¼ˆåœ†å½¢å£°æ³¢å›¾æ ‡ï¼‰
- æœ‰è¾“å…¥ï¼šå‘é€æ¨¡å¼ï¼ˆç™½åº•é»‘è‰²å‘ä¸Šç®­å¤´ï¼Œæå‡å¯¹æ¯”åº¦ï¼‰
- AI å›å¤ä¸­ï¼šåœæ­¢æ¨¡å¼ï¼ˆçº¢è‰²æ–¹å½¢ï¼Œå¯ç«‹å³ç»ˆæ­¢ç”Ÿæˆï¼‰

#### âœ… æ€è€ƒä¸æ‰“å­—åŠ¨ç”»
- æ€è€ƒå ä½ï¼šç™½è‰²å°åœ†ç‚¹æ‰©å¼ è„‰å†²åŠ¨ç”»ï¼ˆstatus = thinkingï¼‰
- æ‰“å­—è¿‡ç¨‹ï¼šé€å­—å¡«å……å†…å®¹ï¼ˆ16ms ~60fpsï¼‰ï¼ŒçŠ¶æ€ä» typing â†’ done
- é—ªçƒå…‰æ ‡ï¼šåœ¨æ‰“å­—é˜¶æ®µé€šè¿‡ä¼ªå…ƒç´ å®ç°ï¼ˆCSS caretBlinkï¼‰
- åœæ­¢ç”Ÿæˆï¼šç«‹å³æ¸…ç©ºå®šæ—¶å™¨ï¼Œç›´æ¥å¡«å……å®Œæ•´å†…å®¹å¹¶çŠ¶æ€ç½®ä¸º done

#### âœ… æŠ€æœ¯å®ç°è¦ç‚¹
```js
// stores/chat.js ç‰‡æ®µ
messages.value.push({ id: placeholderId, role: 'assistant', content: '', status: 'thinking' });
// è¯·æ±‚è¿”å›åï¼šstatus = 'typing'ï¼Œé€æ­¥å†™å…¥ content
```
```css
.thinking-dot { animation: thinkingPulse 1s ease-in-out infinite; }
.md-content.typing:after { animation: caretBlink .9s steps(2,start) infinite; }
```

#### âœ… åœæ­¢ç”Ÿæˆé€»è¾‘
- æ–°å¢ `stopGeneration()`ï¼ˆstore + viewï¼‰ç»Ÿä¸€ç»“æŸæ‰“å­—å¹¶å±•ç¤ºå®Œæ•´ç»“æœ
- é‡Šæ”¾å®šæ—¶å™¨é˜²æ­¢å†…å­˜æ³„æ¼

#### ğŸ§ª å·²éªŒè¯
- æ¶ˆæ¯ç«‹å³æ˜¾ç¤ºç”¨æˆ·è¾“å…¥å†å¼‚æ­¥å¤„ç† AI å›å¤
- åœæ­¢æŒ‰é’®åœ¨æ‰“å­—é˜¶æ®µå¯ç”¨ï¼Œç‚¹å‡»åå…‰æ ‡æ¶ˆå¤±
- é•¿å›å¤æŒ‰é•¿åº¦åŠ¨æ€ stepï¼ˆçº¦ 60 æ­¥å®Œæˆï¼‰

#### ğŸ“Œ åç»­å¯é€‰ä¼˜åŒ–
- æµå¼ä¼ è¾“æ”¹é€ ï¼šåç«¯æ”¯æŒåˆ†ç‰‡ SSE/WebSocket æ—¶æ›¿æ¢å½“å‰å®šæ—¶å™¨æ–¹æ¡ˆ
- æ‰“å­—é€Ÿåº¦è‡ªå®šä¹‰ï¼šåŠ å…¥è®¾ç½®é¢æ¿è°ƒèŠ‚é€Ÿåº¦/æ˜¯å¦å¯ç”¨åŠ¨ç”»
- æ€è€ƒé˜¶æ®µæç¤ºæ–‡æ¡ˆï¼šå¯åŠ â€œæ­£åœ¨æ€è€ƒâ€¦â€ä¸‹æ–¹ç°è‰²è½»æç¤º

**æœ€åæ›´æ–°**: 2025-11-20  XX:XX ï¼ˆè¯·åˆ·æ–°åç«¯è‹¥éœ€æ ¡å‡†æ—¶é—´ï¼‰
**å½“å‰çŠ¶æ€**: ä¸»æŒ‰é’®äº¤äº’ä¸å›å¤åŠ¨ç”»ä¸Šçº¿
