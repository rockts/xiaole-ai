<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content">
    <title>å°ä¹ AI ç®¡å®¶ v0.8.0</title>
    <script>
        // è°ƒè¯•å·¥å…·: æŒ‰ Ctrl+Shift+D æ¸…é™¤è®¤è¯ä¿¡æ¯
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                console.log('ğŸ”§ æ¸…é™¤è®¤è¯ä¿¡æ¯...');
                localStorage.removeItem('token');
                localStorage.removeItem('user');
                alert('å·²æ¸…é™¤tokenå’Œuserï¼Œå³å°†åˆ·æ–°é¡µé¢');
                location.reload();
            }
        });

        // å¯åŠ¨æ—¶æ£€æŸ¥tokenæœ‰æ•ˆæ€§
        (function () {
            const token = localStorage.getItem('token');
            if (token) {
                console.log('ğŸ” æ£€æµ‹åˆ°tokenï¼ŒéªŒè¯ä¸­...');
                fetch('http://localhost:8000/api/sessions', {
                    headers: { 'Authorization': 'Bearer ' + token }
                }).then(res => {
                    if (res.status === 401) {
                        console.warn('âš ï¸ Tokenæ— æ•ˆï¼Œæ¸…é™¤ä¸­...');
                        localStorage.removeItem('token');
                        localStorage.removeItem('user');
                        if (window.location.pathname !== '/login') {
                            window.location.href = '/login';
                        }
                    } else {
                        console.log('âœ… Tokenæœ‰æ•ˆ');
                    }
                }).catch(err => {
                    console.error('âŒ TokenéªŒè¯å¤±è´¥:', err);
                });
            } else {
                console.log('â„¹ï¸ æœªæ£€æµ‹åˆ°token');
            }
        })();
    </script>
</head>

<body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
</body>

</html>