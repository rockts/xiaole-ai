#!/usr/bin/env python3
"""
æµ‹è¯•ä¸»åŠ¨é—®ç­”ä¿®å¤ï¼š
1. é—®é¢˜è¯†åˆ«ï¼ˆæ–°å¢"ä»€ä¹ˆæ—¶å€™"ç­‰å…³é”®è¯ï¼‰
2. å»é‡é€»è¾‘ï¼ˆé¿å…è·¨ä¼šè¯é‡å¤ï¼‰
"""
from proactive_qa import ProactiveQA
import os
import sys
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))


def main():
    print("=" * 70)
    print("ğŸ§ª æµ‹è¯•ä¸»åŠ¨é—®ç­”ä¿®å¤")
    print("=" * 70)

    qa = ProactiveQA()

    # æµ‹è¯•1: é—®é¢˜è¯†åˆ«ï¼ˆæ–°å¢çš„å…³é”®è¯ï¼‰
    print("\nğŸ“Œ æµ‹è¯•1: é—®é¢˜è¯†åˆ«ï¼ˆæ–°å¢ç–‘é—®è¯ï¼‰")
    print("-" * 70)

    test_cases = [
        ("æˆ‘ä»¬æœ€è¿‘ä¸€æ¬¡èŠè´­ç‰©æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ", True, "ä»€ä¹ˆæ—¶å€™ï¼ˆæ—¶é—´ï¼‰"),
        ("ä½ åœ¨å“ªé‡Œå·¥ä½œï¼Ÿ", True, "å“ªé‡Œï¼ˆåœ°ç‚¹ï¼‰"),
        ("ä½ å–œæ¬¢å“ªä¸ªæ¡†æ¶ï¼Ÿ", True, "å“ªä¸ªï¼ˆé€‰æ‹©ï¼‰"),
        ("æœ‰å‡ ä¸ªé€‰é¡¹ï¼Ÿ", True, "å‡ ä¸ªï¼ˆæ•°é‡ï¼‰"),
        ("æ€æ ·æ‰èƒ½å­¦å¥½Pythonï¼Ÿ", True, "æ€æ ·ï¼ˆæ–¹å¼ï¼‰"),
        ("è¿™æ˜¯ä»€ä¹ˆæ—¶å€™çš„äº‹ï¼Ÿ", True, "ä»€ä¹ˆæ—¶å€™"),
        ("ä»Šå¤©å¤©æ°”ä¸é”™", False, "é™ˆè¿°å¥"),
    ]

    for text, expected, reason in test_cases:
        result = qa.is_question(text)
        status = "âœ…" if result == expected else "âŒ"
        print(f"{status} \"{text}\"")
        print(f"   è¯†åˆ«ç»“æœ: {result} | æœŸæœ›: {expected} | åŸå› : {reason}")

    # æµ‹è¯•2: ä¸å®Œæ•´å›ç­”è¯†åˆ«
    print("\nğŸ“Œ æµ‹è¯•2: ä¸å®Œæ•´å›ç­”è¯†åˆ«")
    print("-" * 70)

    answer_cases = [
        ("æˆ‘ä¸å¤ªç¡®å®šå…·ä½“æ—¶é—´", True, "åŒ…å«'ä¸å¤ªç¡®å®š'"),
        ("å¯èƒ½æ˜¯ä¸Šå‘¨å§", True, "åŒ…å«'å¯èƒ½'"),
        ("åº”è¯¥å·®ä¸å¤š", True, "åŒ…å«'åº”è¯¥'"),
        ("ä¸Šä¸ªæœˆæˆ‘ä»¬è®¨è®ºè¿‡ç”µå­äº§å“ï¼ŒåŒ…æ‹¬æ‰‹æœºå’Œå¹³æ¿", False, "å®Œæ•´å›ç­”"),
    ]

    for text, expected, reason in answer_cases:
        result = qa.is_incomplete_answer(text)
        status = "âœ…" if result == expected else "âŒ"
        print(f"{status} \"{text}\"")
        print(f"   è¯†åˆ«ç»“æœ: {result} | æœŸæœ›: {expected} | åŸå› : {reason}")

    # æµ‹è¯•3: ç½®ä¿¡åº¦è®¡ç®—
    print("\nğŸ“Œ æµ‹è¯•3: ç½®ä¿¡åº¦è®¡ç®—")
    print("-" * 70)

    conf_cases = [
        ("æˆ‘ä»¬æœ€è¿‘ä¸€æ¬¡èŠè´­ç‰©æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ", "æˆ‘ä¸å¤ªç¡®å®š", ["æ—¶é—´ä¿¡æ¯"]),
        ("åœ¨å“ªé‡Œä¹°çš„ï¼Ÿ", "å¯èƒ½æ˜¯ç½‘ä¸Š", ["å…·ä½“åœ°ç‚¹"]),
        ("æ€æ ·å­¦å¥½Pythonï¼Ÿ", "ä¸çŸ¥é“", ["æ“ä½œæ–¹æ³•"]),
    ]

    for question, answer, missing in conf_cases:
        confidence = qa._calculate_confidence(question, answer, missing)
        print(f"Q: {question}")
        print(f"A: {answer}")
        print(f"ç¼ºå¤±: {missing}")
        print(f"ğŸ“Š ç½®ä¿¡åº¦: {confidence}%")
        print()

    print("=" * 70)
    print("âœ… æµ‹è¯•å®Œæˆï¼")
    print("=" * 70)
    print("\nğŸ’¡ ä¸»è¦ä¿®å¤:")
    print("1. æ–°å¢é—®é¢˜è¯†åˆ«å…³é”®è¯ï¼šä»€ä¹ˆæ—¶å€™ã€å“ªé‡Œã€å“ªä¸ªã€å‡ ä¸ªã€æ€æ ·")
    print("2. æŸ¥è¯¢å»é‡ï¼šä½¿ç”¨user_id + å­æŸ¥è¯¢ï¼Œé¿å…è·¨ä¼šè¯é‡å¤æ˜¾ç¤º")
    print("3. ä¿å­˜å»é‡ï¼š10åˆ†é’Ÿå†…ç›¸åŒé—®é¢˜ä¸é‡å¤ä¿å­˜")
    print("\nğŸ” ä¸‹ä¸€æ­¥æµ‹è¯•:")
    print("1. åœ¨ç½‘é¡µä¸­é—®: 'æˆ‘ä»¬æœ€è¿‘ä¸€æ¬¡èŠè´­ç‰©æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ'")
    print("2. æ£€æŸ¥ä¸»åŠ¨é—®ç­”å†å²ï¼Œåº”è¯¥ä¸å†æœ‰é‡å¤è®°å½•")
    print("3. æŸ¥çœ‹ç½®ä¿¡åº¦æ ‡ç­¾é¢œè‰²ï¼ˆç»¿/é»„/çº¢ï¼‰")


if __name__ == "__main__":
    main()
